<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ëã±ÂçòË™û„Çπ„Éö„É™„É≥„Ç∞„ÇØ„Ç§„Ç∫</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab {
            flex: 1;
            min-width: 120px;
            padding: 12px 20px;
            background: #f0f0f0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: #667eea;
            color: white;
        }
        
        .tab:hover {
            transform: translateY(-2px);
        }
        
        .view {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .view.active {
            display: block;
        }
        
        .quiz-container {
            text-align: center;
        }
        
        .progress {
            margin-bottom: 20px;
            font-size: 18px;
            color: #666;
            font-weight: 600;
        }
        
        .word-display {
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
            margin: 30px 0;
            min-height: 60px;
        }
        
        .play-button {
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            font-size: 30px;
            cursor: pointer;
            margin: 20px auto;
            display: block;
            box-shadow: 0 5px 15px rgba(102,126,234,0.4);
            transition: all 0.3s;
        }
        
        .play-button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(102,126,234,0.6);
        }
        
        .play-button:active {
            transform: scale(0.95);
        }
        
        .input-group {
            margin: 30px 0;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 15px;
            font-size: 24px;
            border: 2px solid #ddd;
            border-radius: 10px;
            text-align: center;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 30px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            display: none;
        }
        
        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
            display: block;
        }
        
        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
            display: block;
        }
        
        .results {
            text-align: center;
        }
        
        .score {
            font-size: 36px;
            color: #667eea;
            margin: 20px 0;
        }
        
        .word-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .word-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .word-item.marked {
            border-left-color: #ffc107;
            background: #fff3cd;
        }
        
        .word-actions {
            display: flex;
            gap: 8px;
        }
        
        .icon-button {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background 0.3s;
        }
        
        .icon-button:hover {
            background: rgba(102,126,234,0.1);
        }
        
        .add-word-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .add-word-form input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .filter-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 8px 16px;
            background: #f0f0f0;
            border: 2px solid transparent;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        
        @media (max-width: 600px) {
            .word-display {
                font-size: 32px;
            }
            
            input[type="text"] {
                font-size: 18px;
            }
            
            .tab {
                min-width: 100px;
                padding: 10px 15px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <button style="position:fixed;top:20px;left:20px;background:rgba(0,0,0,0.7);color:white;border:2px solid rgba(255,255,255,0.3);padding:12px 25px;border-radius:50px;cursor:pointer;font-size:1.1em;z-index:10000;transition:all 0.3s" onclick="window.location.href='index.html'">‚Üê MeruHub</button>
    <div class="container">
        <div class="header">
            <h1>üéØ Ëã±ÂçòË™û„Çπ„Éö„É™„É≥„Ç∞„ÇØ„Ç§„Ç∫</h1>
            <div class="tabs">
                <button class="tab active" onclick="showView('quiz')">„ÇØ„Ç§„Ç∫</button>
                <button class="tab" onclick="showView('list')">ÂçòË™û‰∏ÄË¶ß</button>
                <button class="tab" onclick="showView('stats')">Áµ±Ë®à</button>
            </div>
        </div>
        
        <!-- „ÇØ„Ç§„Ç∫„Éì„É•„Éº -->
        <div id="quiz-view" class="view active">
            <div class="quiz-container">
                <div id="mode-selection" style="margin-bottom: 30px;">
                    <h3 style="text-align: center; margin-bottom: 15px;">„ÇØ„Ç§„Ç∫„É¢„Éº„Éâ„ÇíÈÅ∏Êäû</h3>
                    <div class="button-group">
                        <button class="btn-primary" onclick="startQuiz('all')">ÂÖ®„Å¶„ÅÆÂçòË™û</button>
                        <button class="btn-primary" onclick="startQuiz('incorrect')">‰∏çÊ≠£Ëß£„ÅÆÂçòË™û„ÅÆ„Åø</button>
                        <button class="btn-primary" onclick="startQuiz('notdone')">Êú™Â≠¶Áøí„ÅÆÂçòË™û„ÅÆ„Åø</button>
                        <button class="btn-primary" onclick="startQuiz('marked')">„Éû„Éº„ÇØÊ∏à„Åø„ÅÆ„Åø</button>
                    </div>
                </div>
                
                <div id="quiz-area" style="display: none;">
                    <div class="progress">
                        <span id="current-index">0</span> / <span id="total-words">0</span>
                        <span id="current-mode" style="margin-left: 15px; color: #667eea; font-weight: bold;"></span>
                    </div>
                    
                    <button class="play-button" id="play-btn" onclick="playWord()">‚ñ∂</button>
                    
                    <div class="word-display" id="word-display">„Çπ„Çø„Éº„Éà„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                    
                    <div class="input-group">
                        <input type="text" id="answer-input" placeholder="„Çπ„Éö„É´„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ" disabled>
                    </div>
                    
                    <div class="feedback" id="feedback"></div>
                    
                    <div class="button-group">
                        <button class="btn-primary" id="check-btn" onclick="checkAnswer()" disabled>„ÉÅ„Çß„ÉÉ„ÇØ</button>
                        <button class="btn-secondary" id="skip-btn" onclick="skipWord()" disabled>„Çπ„Ç≠„ÉÉ„Éó</button>
                        <button class="btn-secondary" onclick="backToModeSelection()">„É¢„Éº„ÉâÈÅ∏Êäû„Å´Êàª„Çã</button>
                    </div>
                </div>
            </div>
            
            <div class="results" id="results" style="display:none;">
                <h2>„ÇØ„Ç§„Ç∫ÂÆå‰∫ÜÔºÅ</h2>
                <div class="score">
                    Ê≠£Ëß£: <span id="correct-count">0</span> / <span id="total-count">0</span>
                </div>
                <div class="button-group">
                    <button class="btn-success" onclick="reviewMistakes()">ÈñìÈÅï„Åà„ÅüÂçòË™û„ÇíÂæ©Áøí</button>
                    <button class="btn-primary" onclick="backToModeSelection()">„É¢„Éº„ÉâÈÅ∏Êäû„Å´Êàª„Çã</button>
                </div>
            </div>
        </div>
        
        <!-- ÂçòË™û‰∏ÄË¶ß„Éì„É•„Éº -->
        <div id="list-view" class="view">
            <h2>ÂçòË™ûÁÆ°ÁêÜ</h2>
            
            <div class="add-word-form">
                <input type="text" id="new-word-input" placeholder="Êñ∞„Åó„ÅÑÂçòË™û„ÇíËøΩÂä†">
                <button class="btn-primary" onclick="addWord()">ËøΩÂä†</button>
            </div>
            
            <div class="filter-buttons">
                <button class="filter-btn active" onclick="filterWords('all')">ÂÖ®„Å¶ (<span id="count-all">0</span>)</button>
                <button class="filter-btn" onclick="filterWords('marked')">„Éû„Éº„ÇØÊ∏à„Åø (<span id="count-marked">0</span>)</button>
                <button class="filter-btn" onclick="filterWords('correct')">Ê≠£Ëß£Ê∏à„Åø (<span id="count-correct">0</span>)</button>
                <button class="filter-btn" onclick="filterWords('incorrect')">‰∏çÊ≠£Ëß£ (<span id="count-incorrect">0</span>)</button>
            </div>
            
            <div class="word-list" id="word-list"></div>
        </div>
        
        <!-- Áµ±Ë®à„Éì„É•„Éº -->
        <div id="stats-view" class="view">
            <h2>Â≠¶ÁøíÁµ±Ë®à</h2>
            
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="stat-total">0</div>
                    <div class="stat-label">Á∑èÂçòË™ûÊï∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-learned">0</div>
                    <div class="stat-label">Â≠¶ÁøíÊ∏à„Åø</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-marked">0</div>
                    <div class="stat-label">„Éû„Éº„ÇØÊ∏à„Åø</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-accuracy">0%</div>
                    <div class="stat-label">Ê≠£Ëß£Áéá</div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn-primary" onclick="checkAndUpdateWords()">Êñ∞„Åó„ÅÑÂçòË™û„ÇíÁ¢∫Ë™ç</button>
                <button class="btn-secondary" onclick="exportData()">„Éá„Éº„Çø„Çí„Ç®„ÇØ„Çπ„Éù„Éº„Éà</button>
                <button class="btn-secondary" onclick="importData()">„Éá„Éº„Çø„Çí„Ç§„É≥„Éù„Éº„Éà</button>
                <button class="btn-danger" onclick="resetAllData()">„Éá„Éº„Çø„Çí„É™„Çª„ÉÉ„Éà</button>
            </div>
        </div>
    </div>
    
    <script>
        // ÂàùÊúüÂçòË™û„É™„Çπ„Éà
        const initialWords = ["Build","Arrive","Throw","Fly","Cry","Climb","Laugh","Village","Thousand","Rule","Cloud","Careful","Wonderful","Heavy","Glad","Low","Angry","Loud","Through","Observe","Burn","Control","Sink","Appreciate","Feed","Mystery","Scene","Trust","Courage","Board","Purpose","Spirit","Partner","Structure","Combination","Flat","Ordinary","Honest","Excellent","Whole","Fresh","Convenient","Secret","Release","Examine","Float","Supply","Apologize","Pull","Surround","Doubt","Support","Compare","Reality","Pleasure","Pattern","Degree","Depth","Theme","Rhythm","Theory","Blank","Smooth","Double","Silent","Weak","Upper","Inner","Beg","Freeze","Measure","Fulfill","Knock","Rush","Pray","Press","Defend","Shut","Bear","Dozen","Shadow","Plenty","Ambition","Quarter","Quantity","Fault","Throughout","Toward","Except","Beside","Beneath","Relative","Ancestor","Occupation","Career","Hire","Clerk","Director","Actor","Secretary","Chairperson","Royal","Gym","Theater","Studio","Architecture","Market","Slope","Traffic","Railroad","Engine","License","Canel","Upstairs","Floor","Roof","Ladder","Refrigerator","Brush","Comb","Blanket","Sheet","Envelope","Clothes","Sew","Frame","Button","Ring","Jewel","Umbrella","Cotton","Leather","Supper","Dessert","Bitter","Sour","Recipe","Fry","Wheat","Flour","Honey","Service","Amusement","Exhibit","Tune","Portrait","Guide","Souvenir","Prize","Award","Coach","Sunlight","Ocean","Coast","Shore","Valley","Desert","Sand","Mud","Environment","Pollution","Disaster","Earthquake","Flood","Rescue","Species","Dinosaur","Bark","Bloom","Seed","Crowd","Female","Youth","Adult","Senior","Elderly","Physical","Thin","Ugly","Sweat","Ambulance","Disease","Headache","Breathe","Cream","Whisper","Bow","Bend","Forehead","Cheek","Lip","Throat","Shoulder","Elbow","Thumb","Ankle","Heart","Stomach","Blood","Emotion","Pleasant","Shocked","Relaxed","Humor","Frank","Cheerful","Calm","Lazy","Text","Address","Claim","Blame","Describe","Novel","Journal","Intelligent","College","Scholar","Chemical","Oxygen","Artificial","Energy","Battery","Gas","Coal","Steel","Astronaut","Reward","Cheap","Committee","Guard","Arrest","Murder","Rob","Drug","Poverty","Liberty","Solider","Weapon","Bomb","Spread","Fold","Owe","Lend","Complain","Warn","Imagine","Iron","Stuff","Baggage","Ability","Fare","Pleased","Satisfied","Bored","Confused","Scared","Clever","Silly","Foolish","Stupid","Necessary","Wrong","Pretty","Sharp","Whichever","Allow","Suggest","Encourage","Factor","Rate","Risk","Sense","Opportunity","Behavior","Following","Concerned","Modern","Serve","Wonder","Promote","Survive","Divide","Achieve","Reveal","Rely","Bother","Struggle","Trouble","Deal","Feature","Attitude","Row","Occasion","Balance","Symbol","Circle","Leisure","Comfortable","Anxious","Opposite","Thick","Narrow","Actually","Abroad","Immediately","Whether","Besides"];
        
        // Áä∂ÊÖãÁÆ°ÁêÜ
        let words = [];
        let currentIndex = 0;
        let quizWords = [];
        let mistakes = [];
        let correctCount = 0;
        let currentFilter = 'all';
        let currentQuizMode = 'all'; // „ÇØ„Ç§„Ç∫„É¢„Éº„Éâ
        
        // ÂàùÊúüÂåñ
        function init() {
            loadData();
            
            // Êñ∞„Åó„ÅÑÂçòË™û„Çí„Éû„Éº„Ç∏
            mergeNewWords();
            
            updateWordList();
            updateStats();
            showModeSelection();
        }
        
        // Êñ∞„Åó„ÅÑÂçòË™û„ÇíÊó¢Â≠ò„Éá„Éº„Çø„Å´„Éû„Éº„Ç∏
        function mergeNewWords() {
            const existingWordTexts = words.map(w => w.text);
            let newWordsAdded = 0;
            
            initialWords.forEach(word => {
                if (!existingWordTexts.includes(word)) {
                    words.push({
                        text: word,
                        marked: false,
                        correct: 0,
                        incorrect: 0
                    });
                    newWordsAdded++;
                }
            });
            
            if (newWordsAdded > 0) {
                saveData();
                console.log(`${newWordsAdded}ÂÄã„ÅÆÊñ∞„Åó„ÅÑÂçòË™û„ÇíËøΩÂä†„Åó„Åæ„Åó„Åü`);
            }
            
            // ÂçòË™û„É™„Çπ„Éà„ÅåÁ©∫„ÅÆÂ†¥Âêà„ÅØÂàùÊúü„Éá„Éº„Çø„Çí„É≠„Éº„Éâ
            if (words.length === 0) {
                words = initialWords.map(word => ({
                    text: word,
                    marked: false,
                    correct: 0,
                    incorrect: 0
                }));
                saveData();
            }
        }
        
        // „É¢„Éº„ÉâÈÅ∏ÊäûÁîªÈù¢„ÇíË°®Á§∫
        function showModeSelection() {
            document.getElementById('mode-selection').style.display = 'block';
            document.getElementById('quiz-area').style.display = 'none';
            document.getElementById('results').style.display = 'none';
        }
        
        // „É¢„Éº„ÉâÈÅ∏Êäû„Å´Êàª„Çã
        function backToModeSelection() {
            showModeSelection();
        }
        
        // „ÇØ„Ç§„Ç∫„ÇíÈñãÂßã
        function startQuiz(mode) {
            currentQuizMode = mode;
            
            // „É¢„Éº„Éâ„Å´Âøú„Åò„Å¶ÂçòË™û„Çí„Éï„Ç£„É´„Çø„É™„É≥„Ç∞
            switch(mode) {
                case 'all':
                    quizWords = [...words];
                    document.getElementById('current-mode').textContent = '(ÂÖ®„Å¶„ÅÆÂçòË™û)';
                    break;
                case 'incorrect':
                    quizWords = words.filter(w => w.incorrect > 0);
                    document.getElementById('current-mode').textContent = '(‰∏çÊ≠£Ëß£„ÅÆÂçòË™û)';
                    break;
                case 'notdone':
                    quizWords = words.filter(w => w.correct === 0 && w.incorrect === 0);
                    document.getElementById('current-mode').textContent = '(Êú™Â≠¶Áøí„ÅÆÂçòË™û)';
                    break;
                case 'marked':
                    quizWords = words.filter(w => w.marked);
                    document.getElementById('current-mode').textContent = '(„Éû„Éº„ÇØÊ∏à„Åø„ÅÆÂçòË™û)';
                    break;
            }
            
            // Ë©≤ÂΩì„Åô„ÇãÂçòË™û„Åå„Å™„ÅÑÂ†¥Âêà
            if (quizWords.length === 0) {
                let message = '';
                switch(mode) {
                    case 'incorrect':
                        message = '‰∏çÊ≠£Ëß£„ÅÆÂçòË™û„Åå„ÅÇ„Çä„Åæ„Åõ„ÇìÔºÅ';
                        break;
                    case 'notdone':
                        message = 'Êú™Â≠¶Áøí„ÅÆÂçòË™û„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇÂÖ®„Å¶„ÅÆÂçòË™û„ÇíÂ≠¶ÁøíÊ∏à„Åø„Åß„ÅôÔºÅ';
                        break;
                    case 'marked':
                        message = '„Éû„Éº„ÇØÊ∏à„Åø„ÅÆÂçòË™û„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇÂçòË™û‰∏ÄË¶ß„Åã„Çâ„Éû„Éº„ÇØ„Çí‰ªò„Åë„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';
                        break;
                }
                alert(message);
                return;
            }
            
            // „É©„É≥„ÉÄ„É†„Å´„Ç∑„É£„ÉÉ„Éï„É´
            shuffleArray(quizWords);
            
            // „ÇØ„Ç§„Ç∫„Ç®„É™„Ç¢„ÇíË°®Á§∫
            document.getElementById('mode-selection').style.display = 'none';
            document.getElementById('quiz-area').style.display = 'block';
            
            // „ÇØ„Ç§„Ç∫„Çí„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó
            currentIndex = 0;
            mistakes = [];
            correctCount = 0;
            
            document.getElementById('total-words').textContent = quizWords.length;
            document.getElementById('current-index').textContent = '0';
            document.getElementById('word-display').textContent = '„Çπ„Çø„Éº„Éà„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
            document.getElementById('answer-input').value = '';
            document.getElementById('answer-input').disabled = true;
            document.getElementById('check-btn').disabled = true;
            document.getElementById('skip-btn').disabled = true;
            document.getElementById('feedback').style.display = 'none';
        }
        
        // ÈÖçÂàó„Çí„É©„É≥„ÉÄ„É†„Å´„Ç∑„É£„ÉÉ„Éï„É´ÔºàFisher-Yates „Ç¢„É´„Ç¥„É™„Ç∫„É†Ôºâ
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // Èü≥Â£∞ÂÜçÁîü
        function playWord() {
            if (currentIndex >= quizWords.length) return;
            
            const word = quizWords[currentIndex].text;
            
            // Èü≥Â£∞„Çí„ÇØ„É™„Ç¢„Åó„Å¶„Åã„ÇâÂÜçÁîü
            speechSynthesis.cancel();
            
            const utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = 'en-US';
            utterance.rate = 0.75;
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            
            speechSynthesis.speak(utterance);
            
            document.getElementById('word-display').textContent = 'üîä ËÅû„ÅÑ„Å¶ÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
            document.getElementById('answer-input').disabled = false;
            document.getElementById('check-btn').disabled = false;
            document.getElementById('skip-btn').disabled = false;
            document.getElementById('answer-input').focus();
            document.getElementById('current-index').textContent = currentIndex + 1;
        }
        
        // Á≠î„Åà„Çí„ÉÅ„Çß„ÉÉ„ÇØ
        function checkAnswer() {
            const userAnswer = document.getElementById('answer-input').value.trim();
            const correctAnswer = quizWords[currentIndex].text;
            const feedback = document.getElementById('feedback');
            
            if (!userAnswer) {
                alert('„Çπ„Éö„É´„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            // ÂÖ•ÂäõÊ¨Ñ„Å®Á¢∫Ë™ç„Éú„Çø„É≥„ÇíÁÑ°ÂäπÂåñ
            document.getElementById('answer-input').disabled = true;
            document.getElementById('check-btn').disabled = true;
            document.getElementById('skip-btn').disabled = true;
            
            if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
                feedback.className = 'feedback correct';
                feedback.style.display = 'block';
                feedback.textContent = `‚úì Ê≠£Ëß£ÔºÅ Ê≠£„Åó„ÅÑ„Çπ„Éö„É´: ${correctAnswer}`;
                correctCount++;
                words.find(w => w.text === correctAnswer).correct++;
            } else {
                feedback.className = 'feedback incorrect';
                feedback.style.display = 'block';
                feedback.textContent = `‚úó ‰∏çÊ≠£Ëß£„ÄÄ„ÅÇ„Å™„Åü„ÅÆÁ≠î„Åà: ${userAnswer}„ÄÄÊ≠£„Åó„ÅÑ„Çπ„Éö„É´: ${correctAnswer}`;
                mistakes.push(quizWords[currentIndex]);
                words.find(w => w.text === correctAnswer).incorrect++;
            }
            
            saveData();
            
            // 3ÁßíÂæå„Å´Ëá™ÂãïÁöÑ„Å´Ê¨°„Å∏
            setTimeout(() => {
                nextWord();
            }, 3000);
        }
        
        // Ê¨°„ÅÆÂçòË™û„Å∏
        function nextWord() {
            currentIndex++;
            document.getElementById('answer-input').value = '';
            document.getElementById('feedback').style.display = 'none';
            document.getElementById('feedback').className = 'feedback';
            
            if (currentIndex >= quizWords.length) {
                showResults();
            } else {
                // Ê¨°„ÅÆÂçòË™û„ÇíËá™ÂãïÁöÑ„Å´ÂÜçÁîü
                setTimeout(() => {
                    playWord();
                }, 500);
            }
        }
        
        // „Çπ„Ç≠„ÉÉ„Éó
        function skipWord() {
            const correctAnswer = quizWords[currentIndex].text;
            mistakes.push(quizWords[currentIndex]);
            
            const feedback = document.getElementById('feedback');
            feedback.className = 'feedback incorrect';
            feedback.style.display = 'block';
            feedback.textContent = `„Çπ„Ç≠„ÉÉ„Éó„Åó„Åæ„Åó„Åü„ÄÄÊ≠£„Åó„ÅÑ„Çπ„Éö„É´: ${correctAnswer}`;
            
            // ÂÖ•ÂäõÊ¨Ñ„Å®Á¢∫Ë™ç„Éú„Çø„É≥„ÇíÁÑ°ÂäπÂåñ
            document.getElementById('answer-input').disabled = true;
            document.getElementById('check-btn').disabled = true;
            document.getElementById('skip-btn').disabled = true;
            
            // 3ÁßíÂæå„Å´Ëá™ÂãïÁöÑ„Å´Ê¨°„Å∏
            setTimeout(() => {
                nextWord();
            }, 3000);
        }
        
        // ÁµêÊûúË°®Á§∫
        function showResults() {
            document.getElementById('quiz-area').style.display = 'none';
            document.getElementById('results').style.display = 'block';
            document.getElementById('correct-count').textContent = correctCount;
            document.getElementById('total-count').textContent = quizWords.length;
            updateStats();
        }
        
        // ÈñìÈÅï„Åà„ÅüÂçòË™û„ÇíÂæ©Áøí
        function reviewMistakes() {
            if (mistakes.length === 0) {
                alert('ÈñìÈÅï„Åà„ÅüÂçòË™û„ÅØ„ÅÇ„Çä„Åæ„Åõ„ÇìÔºÅ');
                return;
            }
            quizWords = [...mistakes];
            
            // „É©„É≥„ÉÄ„É†„Å´„Ç∑„É£„ÉÉ„Éï„É´
            shuffleArray(quizWords);
            
            currentIndex = 0;
            mistakes = [];
            correctCount = 0;
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('quiz-area').style.display = 'block';
            document.getElementById('total-words').textContent = quizWords.length;
            document.getElementById('current-mode').textContent = '(ÈñìÈÅï„Åà„ÅüÂçòË™û„ÅÆÂæ©Áøí)';
            document.getElementById('word-display').textContent = '„Çπ„Çø„Éº„Éà„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
            document.getElementById('answer-input').value = '';
            document.getElementById('answer-input').disabled = true;
            document.getElementById('check-btn').disabled = true;
            document.getElementById('skip-btn').disabled = true;
            document.getElementById('feedback').style.display = 'none';
        }
        
        // „Éì„É•„ÉºÂàá„ÇäÊõø„Åà
        function showView(viewName) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            
            document.getElementById(viewName + '-view').classList.add('active');
            
            // „ÇØ„É™„ÉÉ„ÇØ„Åï„Çå„Åü„Çø„Éñ„ÇíË¶ã„Å§„Åë„Å¶active„ÇØ„É©„Çπ„ÇíËøΩÂä†
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                if ((viewName === 'quiz' && tab.textContent.includes('„ÇØ„Ç§„Ç∫')) ||
                    (viewName === 'list' && tab.textContent.includes('ÂçòË™û‰∏ÄË¶ß')) ||
                    (viewName === 'stats' && tab.textContent.includes('Áµ±Ë®à'))) {
                    tab.classList.add('active');
                }
            });
            
            if (viewName === 'list') {
                updateWordList();
            } else if (viewName === 'stats') {
                updateStats();
            }
        }
        
        // ÂçòË™û‰∏ÄË¶ßÊõ¥Êñ∞
        function updateWordList() {
            const listContainer = document.getElementById('word-list');
            listContainer.innerHTML = '';
            
            let filteredWords = words;
            if (currentFilter === 'marked') {
                filteredWords = words.filter(w => w.marked);
            } else if (currentFilter === 'correct') {
                filteredWords = words.filter(w => w.correct > 0);
            } else if (currentFilter === 'incorrect') {
                filteredWords = words.filter(w => w.incorrect > 0);
            }
            
            filteredWords.forEach((word, index) => {
                const item = document.createElement('div');
                item.className = 'word-item' + (word.marked ? ' marked' : '');
                item.innerHTML = `
                    <div>
                        <strong>${word.text}</strong>
                        <span style="margin-left: 10px; font-size: 12px; color: #666;">
                            ‚úì${word.correct} ‚úó${word.incorrect}
                        </span>
                    </div>
                    <div class="word-actions">
                        <button class="icon-button" onclick="playWordByText('${word.text}')" title="Áô∫Èü≥„ÇíËÅû„Åè">üîä</button>
                        <button class="icon-button" onclick="toggleMark('${word.text}')" title="„Éû„Éº„ÇØ">${word.marked ? '‚≠ê' : '‚òÜ'}</button>
                        <button class="icon-button" onclick="deleteWord('${word.text}')" title="ÂâäÈô§">üóëÔ∏è</button>
                    </div>
                `;
                listContainer.appendChild(item);
            });
            
            // „Ç´„Ç¶„É≥„ÉàÊõ¥Êñ∞
            document.getElementById('count-all').textContent = words.length;
            document.getElementById('count-marked').textContent = words.filter(w => w.marked).length;
            document.getElementById('count-correct').textContent = words.filter(w => w.correct > 0).length;
            document.getElementById('count-incorrect').textContent = words.filter(w => w.incorrect > 0).length;
        }
        
        // ÂçòË™ûËøΩÂä†
        function addWord() {
            const input = document.getElementById('new-word-input');
            const newWord = input.value.trim();
            
            if (!newWord) {
                alert('ÂçòË™û„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            if (words.some(w => w.text.toLowerCase() === newWord.toLowerCase())) {
                alert('„Åì„ÅÆÂçòË™û„ÅØÊó¢„Å´Â≠òÂú®„Åó„Åæ„Åô');
                return;
            }
            
            words.push({
                text: newWord,
                marked: false,
                correct: 0,
                incorrect: 0
            });
            
            input.value = '';
            saveData();
            updateWordList();
            updateStats();
        }
        
        // ÂçòË™ûÂâäÈô§
        function deleteWord(text) {
            if (confirm(`"${text}" „ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü`)) {
                words = words.filter(w => w.text !== text);
                saveData();
                updateWordList();
                updateStats();
            }
        }
        
        // „Éû„Éº„ÇØ„Éà„Ç∞„É´
        function toggleMark(text) {
            const word = words.find(w => w.text === text);
            if (word) {
                word.marked = !word.marked;
                saveData();
                updateWordList();
                updateStats();
            }
        }
        
        // „ÉÜ„Ç≠„Çπ„Éà„ÅßÁô∫Èü≥
        function playWordByText(text) {
            speechSynthesis.cancel();
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.75;
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            
            speechSynthesis.speak(utterance);
        }
        
        // „Éï„Ç£„É´„Çø„Éº
        function filterWords(filter) {
            currentFilter = filter;
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            
            // „ÇØ„É™„ÉÉ„ÇØ„Åï„Çå„Åü„Éú„Çø„É≥„ÇíË¶ã„Å§„Åë„Å¶active„ÇØ„É©„Çπ„ÇíËøΩÂä†
            const buttons = document.querySelectorAll('.filter-btn');
            buttons.forEach(btn => {
                if ((filter === 'all' && btn.textContent.includes('ÂÖ®„Å¶')) ||
                    (filter === 'marked' && btn.textContent.includes('„Éû„Éº„ÇØÊ∏à„Åø')) ||
                    (filter === 'correct' && btn.textContent.includes('Ê≠£Ëß£Ê∏à„Åø')) ||
                    (filter === 'incorrect' && btn.textContent.includes('‰∏çÊ≠£Ëß£'))) {
                    btn.classList.add('active');
                }
            });
            
            updateWordList();
        }
        
        // Áµ±Ë®àÊõ¥Êñ∞
        function updateStats() {
            const total = words.length;
            const learned = words.filter(w => w.correct > 0 || w.incorrect > 0).length;
            const marked = words.filter(w => w.marked).length;
            const totalAttempts = words.reduce((sum, w) => sum + w.correct + w.incorrect, 0);
            const totalCorrect = words.reduce((sum, w) => sum + w.correct, 0);
            const accuracy = totalAttempts > 0 ? Math.round((totalCorrect / totalAttempts) * 100) : 0;
            
            document.getElementById('stat-total').textContent = total;
            document.getElementById('stat-learned').textContent = learned;
            document.getElementById('stat-marked').textContent = marked;
            document.getElementById('stat-accuracy').textContent = accuracy + '%';
        }
        
        // „Éá„Éº„Çø‰øùÂ≠ò
        function saveData() {
            localStorage.setItem('spellingQuizWords', JSON.stringify(words));
        }
        
        // „Éá„Éº„ÇøË™≠„ÅøËæº„Åø
        function loadData() {
            const saved = localStorage.getItem('spellingQuizWords');
            if (saved) {
                words = JSON.parse(saved);
            }
        }
        
        // „Éá„Éº„Çø„Ç®„ÇØ„Çπ„Éù„Éº„Éà
        function exportData() {
            const dataStr = JSON.stringify(words, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'spelling_quiz_data.json';
            link.click();
        }
        
        // „Éá„Éº„Çø„Ç§„É≥„Éù„Éº„Éà
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'application/json';
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = event => {
                    try {
                        const imported = JSON.parse(event.target.result);
                        if (confirm('„Ç§„É≥„Éù„Éº„Éà„Åô„Çã„Å®ÁèæÂú®„ÅÆ„Éá„Éº„Çø„Åå‰∏äÊõ∏„Åç„Åï„Çå„Åæ„Åô„ÄÇÁ∂ö„Åë„Åæ„Åô„ÅãÔºü')) {
                            words = imported;
                            saveData();
                            updateWordList();
                            updateStats();
                            alert('„Éá„Éº„Çø„Çí„Ç§„É≥„Éù„Éº„Éà„Åó„Åæ„Åó„Åü');
                        }
                    } catch (error) {
                        alert('„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }
        
        // „Éá„Éº„Çø„É™„Çª„ÉÉ„Éà
        function resetAllData() {
            if (confirm('ÂÖ®„Å¶„ÅÆ„Éá„Éº„Çø„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åô„ÅãÔºü„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ')) {
                if (confirm('Êú¨ÂΩì„Å´„Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºüÂÖ®„Å¶„ÅÆÂ≠¶ÁøíÂ±•Ê≠¥„ÅåÂâäÈô§„Åï„Çå„Åæ„Åô„ÄÇ')) {
                    words = initialWords.map(word => ({
                        text: word,
                        marked: false,
                        correct: 0,
                        incorrect: 0
                    }));
                    localStorage.removeItem('spellingQuizWords');
                    saveData();
                    updateWordList();
                    updateStats();
                    showModeSelection();
                    alert('„Éá„Éº„Çø„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åó„Åü');
                }
            }
        }
        
        // Êñ∞„Åó„ÅÑÂçòË™û„ÇíÁ¢∫Ë™ç„Åó„Å¶ËøΩÂä†
        function checkAndUpdateWords() {
            const existingWordTexts = words.map(w => w.text);
            const newWords = initialWords.filter(word => !existingWordTexts.includes(word));
            
            if (newWords.length === 0) {
                alert('Êñ∞„Åó„ÅÑÂçòË™û„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇÂÖ®„Å¶„ÅÆÂçòË™û„ÅåÊó¢„Å´ÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ');
                return;
            }
            
            if (confirm(`${newWords.length}ÂÄã„ÅÆÊñ∞„Åó„ÅÑÂçòË™û„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åó„Åü„ÄÇËøΩÂä†„Åó„Åæ„Åô„ÅãÔºü\n\nÊñ∞„Åó„ÅÑÂçòË™û:\n${newWords.slice(0, 10).join(', ')}${newWords.length > 10 ? '...' : ''}`)) {
                newWords.forEach(word => {
                    words.push({
                        text: word,
                        marked: false,
                        correct: 0,
                        incorrect: 0
                    });
                });
                saveData();
                updateWordList();
                updateStats();
                alert(`${newWords.length}ÂÄã„ÅÆÊñ∞„Åó„ÅÑÂçòË™û„ÇíËøΩÂä†„Åó„Åæ„Åó„ÅüÔºÅ`);
            }
        }
        
        // Enter„Ç≠„Éº„Åß„ÉÅ„Çß„ÉÉ„ÇØ
        document.addEventListener('DOMContentLoaded', () => {
            init();
            
            document.getElementById('answer-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !document.getElementById('check-btn').disabled) {
                    document.getElementById('check-btn').click();
                }
            });
            
            document.getElementById('new-word-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addWord();
                }
            });
        });
    </script>
</body>
</html>
